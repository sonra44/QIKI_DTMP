# Отчёт: proto_extensions/utils/proto_linter.py

## Вход и цель
- [Факт] Утилита для линтинга `.proto` файлов на типовые ошибки.

## Сбор контекста
- [Факт] Проверяет наличие `scalar_data` без `oneof` и `status_code` без `enum`.
- [Факт] Обходит файлы в каталоге `protos`.
- [Гипотеза] Используется в процессе CI.

## Локализация артефакта
- [Факт] Путь: `proto_extensions/utils/proto_linter.py`.
- [Факт] Запуск: `python proto_extensions/utils/proto_linter.py`.
- [Факт] Требует существования каталога `protos`.

## Фактический разбор
- [Факт] `check_oneof_usage` ищет `scalar_data` без ключевого слова `oneof`.
- [Факт] `check_enum_typing` ищет `status_code` без `enum`.
- [Факт] `lint_all` выводит список предупреждений и их количество.
- [Гипотеза] Строковый поиск может давать ложные срабатывания.

## Роль в системе и связи
- [Факт] Предупреждает о распространённых ошибках в протоколах.
- [Гипотеза] Может использоваться как pre-commit hook.

## Несоответствия и риски
- [Гипотеза][Med] Линтер не игнорирует комментарии ⇒ ложные предупреждения.
- [Гипотеза][Low] При наличии ошибок процесс завершается с кодом 0.

## Мини-патчи (safe-fix)
- [Патч][Med] Игнорировать строки комментариев при поиске.
- [Патч][Low] Возвращать ненулевой код при найденных нарушениях.

## Рефактор-скетч
- [Гипотеза] Использовать парсер `.proto` вместо простых строковых проверок.

## Примеры использования
```bash
python proto_extensions/utils/proto_linter.py
```

## Тест-хуки/чек-лист
- [Факт] Линтер сообщает предупреждение при наличии `scalar_data` без `oneof`.
- [Факт] При отсутствии нарушений выводит "✅ No issues found.".

## Вывод
- Утилита покрывает базовые проверки, но подвержена ложным срабатываниям.
- Срочно: учесть комментарии и код возврата.
- Отложить: перейти на парсинг AST.
