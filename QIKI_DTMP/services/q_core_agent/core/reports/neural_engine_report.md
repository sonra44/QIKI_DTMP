# neural_engine.py — обзор

## Вход и цель
- [Факт] анализ модуля `neural_engine.py` и фиксация задач

## Сбор контекста
- [Факт] реализует класс `NeuralEngine` как заглушку `INeuralEngine`
- [Факт] использует `Proposal` и `Timestamp` из protobuf
- [Гипотеза] в будущем заменится на реальную ML-модель

## Локализация артефакта
- [Факт] путь: `services/q_core_agent/core/neural_engine.py`
- [Гипотеза] вызывается из агента через интерфейс `INeuralEngine`

## Фактический разбор
- [Факт] метод `generate_proposals` возвращает список предложений
- [Факт] опция `mock_neural_proposals_enabled` формирует тестовое предложение
- [Гипотеза] нет обработки ошибок и ограничений количества предложений

## Роль в системе и связи
- [Факт] генерирует исходные предложения для последующей оценки
- [Гипотеза] влияет на стратегию агента при включённом мок-режиме

## Несоответствия и риски
- [Факт] фиксированное значение `priority` и `confidence` (Low)
- [Гипотеза] отсутствие валидации входного контекста (Med)

## Мини-патчи (safe-fix)
- [Патч] добавить проверку размера списка перед возвратом
- [Патч] логировать отсутствие мок-предложений при отключённом режиме

## Рефактор-скетч
```python
def generate_proposals(self, ctx):
    if not self.mock_neural_proposals_enabled:
        return []
    return [self._build_mock_proposal()]
```

## Примеры использования
```python
engine = NeuralEngine(context, {"mock_neural_proposals_enabled": True})
engine.generate_proposals(context)
```

## Тест-хуки/чек-лист
- [Факт] unit-тест: проверка генерации одного мок-предложения
- [Гипотеза] интеграция: корректный лог при отключённом мок-режиме

## Вывод
- [Факт] модуль выполняет роль заглушки и требует расширения для реальных моделей
- [Патч] рекомендуется добавить валидацию входов и гибкие параметры приоритета

## Стиль и маркировка
- [Факт] — по исходнику
- [Гипотеза] — по косвенным признакам
- [Патч] — предложенные изменения
