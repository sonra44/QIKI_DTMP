# Отчёт по component.proto.template

## Вход и цель
- [Факт] Разобраться в шаблоне Protocol Buffers для компонента и подготовить рекомендации.

## Сбор контекста
- [Факт] Использует синтаксис `proto3`, пакет `qiki.{{ component_name | lower }}`.
- [Факт] Импортируются `common_types.proto` и `google/protobuf/timestamp.proto`.
- [Гипотеза] Шаблон применяется генератором `qiki-docgen` для создания протокольных контрактов.

## Локализация артефакта
- [Факт] `tools/qiki_docgen/templates/component.proto.template` в репозитории `QIKI_DTMP`.
- [Факт] Генерируемые файлы используются при сборке микросервисов.

## Фактический разбор
- [Факт] Сообщение `{{ component_proto_type }}` содержит поля `id`, `description`, `created_at`.
- [Факт] Комментариями приведены примеры скалярных, `enum`, `repeated`, `oneof` и `map` полей.
- [Гипотеза] Пользователь должен удалить неиспользуемые примеры перед генерацией.

## Роль в системе и связи
- [Факт] Служит основой для описания обмена данными между сервисами.
- [Гипотеза] На базе этого протокола строятся gRPC/REST интерфейсы.

## Несоответствия и риски
- [Гипотеза][Med] Незаполненные поля могут привести к неполному контракту.
- [Гипотеза][Low] Неразобранные комментарии могут утяжелить итоговый файл.

## Мини-патчи (safe-fix)
- [Патч] Добавить в шаблон готовый пример поля `repeated string tags = 4;` для демонстрации списков.

## Рефактор-скетч (по желанию)
```proto
// [Патч] Скелет сообщения без лишних комментариев
message {{ component_proto_type }} {
  qiki.common.UUID id = 1;
  string description = 2;
  google.protobuf.Timestamp created_at = 3;
}
```

## Примеры использования
```bash
# [Факт] Проверка компиляции
protoc --proto_path=. component.proto
```
```python
# [Гипотеза] Создание сообщения на Python
msg = component_pb2.{{ component_proto_type }}(id=qiki.common.UUID())
```

## Тест-хуки/чек-лист
- [Факт] `protoc component.proto` завершился без ошибок.
- [Гипотеза] В unit-тестах проверять обязательность `id` и корректность `created_at`.

## Вывод
- [Факт] Шаблон обеспечивает базовый каркас протокола компонента.
- [Патч] Дополнить специфическими полями и удалить примерные комментарии.
