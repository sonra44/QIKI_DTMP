version: 1
rules:
  - id: TEMP_CORE_SPIKE
    enabled: true
    title: "Core temp spike"
    description: "Core temperature above threshold"
    match:
      type: "sensor"
      source: "thermal"
      subject: "core"
      field: "temp"
    threshold:
      op: ">"
      value: 70
      min_duration_s: 3
      cooldown_s: 30
    severity: "C"
    require_ack: true
    auto_clear: true

  - id: TEMP_CORE_TRIP
    enabled: true
    title: "Core thermal trip"
    description: "Thermal plane reported a TRIP edge for the core node"
    match:
      type: "sensor"
      source: "thermal"
      subject: "core"
      field: "tripped"
    threshold:
      op: "="
      value: 1
      cooldown_s: 60
    severity: "A"
    require_ack: true
    auto_clear: false

  - id: RADAR_SIGNAL_LOSS
    enabled: true
    title: "Radar signal loss"
    description: "Radar signal dropped or lost"
    match:
      type: "radar"
      source: "sensor"
      subject: "ppi"
    threshold:
      op: "="
      value: 0
      min_duration_s: 2
      cooldown_s: 10
    severity: "W"
    require_ack: true
    auto_clear: true

  - id: UNKNOWN_CONTACT_CLOSE
    enabled: true
    title: "Unknown contact close"
    description: "Unknown radar contact in close range (guard rule)"
    match:
      type: "radar"
      source: "guard"
      subject: "UNKNOWN_CONTACT_CLOSE"
      field: "range_m"
    threshold:
      op: "<"
      value: 70
      cooldown_s: 60
    severity: "C"
    require_ack: true
    auto_clear: false

  - id: POWER_BUS_NEAR_LIMIT
    enabled: true
    title: "Power bus near current limit"
    description: "Bus current above warning threshold (approaching limit)"
    match:
      type: "power"
      source: "bus"
      subject: "main"
      field: "current"
    threshold:
      op: ">"
      value: 4
      min_duration_s: 2
      cooldown_s: 30
    severity: "W"
    require_ack: true
    auto_clear: true

  - id: POWER_BUS_OVERLOAD
    enabled: true
    title: "Power bus overload"
    description: "Bus current above safe threshold"
    match:
      type: "power"
      source: "bus"
      subject: "main"
      field: "current"
    threshold:
      op: ">"
      value: 5
      min_duration_s: 2
      cooldown_s: 60
    severity: "A"
    require_ack: true
    auto_clear: false

  - id: POWER_PDU_OVERCURRENT
    enabled: true
    title: "PDU overcurrent"
    description: "Power Distribution Unit reported overcurrent condition"
    match:
      type: "power"
      source: "pdu"
      subject: "main"
      field: "overcurrent"
    threshold:
      op: "="
      value: 1
      min_duration_s: 1
      cooldown_s: 60
    severity: "A"
    require_ack: true
    auto_clear: false
