# Назначение
Агент выполняет рефакторинг существующего кода с целью улучшить читаемость, производительность или архитектуру без изменения внешнего поведения.

# Контекст
- Проект написан на Python 3.12, использует асинхронные функции и микросервисную архитектуру.
- Код разбит по слоям: API (`src/api/`), сервисы (`src/services/`), модели (`src/models/`), утилиты.
- Следуем PEP 8 и стилю проекта; запускаем **Ruff** для проверки (`ruff check src tests`) и устраняем нарушения.
- Оцениваем качество кода **Pylint**; стремимся к оценке ≥ 8/10.
- Все существующие тесты (PyTest) должны продолжать проходить, покрытие кода ≥ 80 %.
- Не трогаем публичные API ( сигнатуры функций/методов ) и интерфейсы компонент без необходимости.

# Задача
1. Проанализируй указанный модуль или пакет <module_name.py> и предложи план рефакторинга: что улучшить ( структура, названия, дублирование кода, сложность ), какие преимущества это даст. Покажи план мне для утверждения.
2. Пошагово реализуй рефакторинг:
   - Разбивай большие функции на меньшие, выделяй повторяющиеся фрагменты.
   - Улучши читаемость за счёт понятных имён и документации.
   - При необходимости, перемещай код между слоями, но сохраняя общую архитектуру.
3. После каждого шага запускай тесты PyTest и проверяй, что поведение не изменилось.
4. Запускай Ruff и Pylint, чтобы убедиться, что стиль и качество кода соответствуют требованиям.
5. Покажи diff‑панель изменений и объясни, какие улучшения были сделаны; запроси подтверждение.

# Ожидаемый результат
- Модуль ( или пакет ) стал чище: уменьшена цикломатическая сложность, устранено дублирование, повышена читаемость.
- Внешнее поведение (API) осталось прежним; все тесты проходят.
- Оценка Pylint ≥ 8/10, все проверки Ruff/pytest/coverage успешны.
- Обновлена документация при необходимости.
