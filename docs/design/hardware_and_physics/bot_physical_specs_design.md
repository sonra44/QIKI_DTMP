
> ⚠️ **Источник правды:** `docs/design/hardware_and_physics/bot_source_of_truth.md`.
> Этот файл описывает формат hardware‑контрактов и пайплайн генерации, но не является единственным источником всех физических параметров.

# Спецификация Физического Устройства Бота (Hardware Contract)

## 1. Обзор
Этот документ является источником правды **о формате hardware-контрактов и пайплайне генерации профилей**. Физические/структурные параметры бота сводятся в `docs/design/hardware_and_physics/bot_source_of_truth.md`, а этот файл задаёт контрактный формат и процесс сборки.

## 2. Система Координат
- **Глобальная ось:** Z-вверх, X-вперед, Y-влево.
- **Центр масс (относительно геометрического центра):** `[0.0, 0.0, 0.1]` (в метрах).
- **Ось симметрии:** Продольная, X.
- **Формат позиции:** `[x_m, y_m, z_m]`.
- **Формат ориентации:** `[roll, pitch, yaw]` (в радианах).

## 3. Контракты на Оборудование
Каждый аппаратный компонент описывается машиночитаемым JSON-контрактом.

### 3.1. Двигательная Установка
```json
{
  "id": "propulsion_left_motor",
  "type": "wheel_motor",
  "mount": "left_wheel_axle",
  "max_force_n": 150,
  "control_mode": "velocity_percent",
  "response_latency_ms": 20
}
```

### 3.2. Сенсорный Комплекс
```json
{
  "id": "lidar_front",
  "type": "lidar",
  "mount_position": [0.5, 0.0, 0.2],
  "mount_orientation": [0, 0, 0],
  "range_m": 100,
  "fov_deg": 180
}
```

## 4. Контроль Целостности и Версионирование
- **`hardware_profile_hash`:** Для отслеживания изменений в конфигурации "железа" вводится `hardware_profile_hash`. 
- **Генерация:** Хэш (SHA256) вычисляется от конкатенированного и отсортированного содержимого всех JSON-контрактов из этого документа.
- **Использование:** Хэш включается во все производные артефакты (`bot_config.json`, логи телеметрии) для обеспечения трассируемости и контроля совместимости.

## 5. Процесс Сборки и Генерации
Данные из этого документа используются в следующей автоматизированной цепочке:

1.  **`bot_physical_specs.md` (этот файл):** Первоисточник, редактируемый человеком.
2.  **`qiki-docgen convert`:** Команда, которая извлекает все JSON-контракты из этого `.md` файла и собирает их в единый `bot_physical_specs.json`.
3.  **`qiki-docgen build-bot-config`:** Команда, которая на основе `bot_physical_specs.json` генерирует `bot_config.json` — конфигурационный файл для `bot_core`.

Эта цепочка гарантирует, что runtime-конфигурация всегда соответствует утвержденной спецификации.

## 6. Открытые Вопросы
1.  Нужно ли добавлять контракты для компонентов, не являющихся сенсорами или актуаторами (например, для CPU, RAM)?
2.  Как будет выглядеть контракт для сложных иерархических сенсоров (например, IMU, который является совокупностью гироскопа и акселерометра)?